select * from EXECUTIVO;

--Consultas basicas
SELECT * FROM EXECUTIVO;
SELECT CODIGO,PRODUTO FROM BIGMAKI;
SELECT UNIDADES FROM SOBREMESA;
SELECT QUANTIDADE, [VALOR DE VENDA], [TOTAL DE VENDAS] FROM YAKISOBA;

--TROCA DE NOMES DAS TABELAS
SELECT CODIGO AS COD, PRODUTO AS [NOME DO PRODUTO], UNIDADES AS LOCALIDADE,
[VALOR DE VENDA] AS [VALOR UNITARIO], QUANTIDADE AS QTD, [TOTAL DE VENDAS] AS [TOTAL BRUTO] FROM HEALTHY;

--Ordenar tabela
SELECT * FROM SOBREMESA ORDER BY PRODUTO;
SELECT * FROM SOBREMESA WHERE QUANTIDADE > 31 ORDER BY PRODUTO;
SELECT * FROM SOBREMESA WHERE [TOTAL DE VENDAS] > 780 ORDER BY UNIDADES;

--Consulta específica
SELECT UNIDADES, [VALOR DE VENDA], [TOTAL DE VENDAS] FROM SOBREMESA
WHERE UNIDADES = 'barra' AND [TOTAL DE VENDAS] >= 600
ORDER BY  [TOTAL DE VENDAS];


SELECT UNIDADES, [VALOR DE VENDA], [TOTAL DE VENDAS] FROM NORI_ESPECIAL
WHERE UNIDADES IN ('copacabana','niteroi') AND [TOTAL DE VENDAS] > 25;

SELECT UNIDADES,PRODUTO FROM P_COMECAR
WHERE NOT (PRODUTO = 'Harumaki legumes') AND UNIDADES = 'niteroi';



--Lista de produtos e unidades
SELECT * FROM NORI_ESPECIAL;
SELECT DISTINCT PRODUTO FROM NORI_ESPECIAL;

SELECT DISTINCT UNIDADES FROM NORI_ESPECIAL;

SELECT COUNT (*)PRODUTO FROM NORI_ESPECIAL WHERE PRODUTO = 'Hosomaki carrot';
SELECT COUNT (*)UNIDADES FROM NORI_ESPECIAL WHERE UNIDADES = 'copacabana';
SELECT COUNT (*)[VALOR DE VENDA] FROM NORI_ESPECIAL WHERE [VALOR DE VENDA]  = 17.90;

SELECT COUNT(*)PRODUTOS, COUNT(*)UNIDADES, COUNT(*)[VALOR DE VENDA] FROM NORI_ESPECIAL;

SELECT COUNT(*)PRODUTO AS [QUANTIDADE DE PRODUTOS], PRODUTO FROM NORI_ESPECIAL;


--Produtos com maior valor de venda

SELECT TOP 10 * FROM POKE WHERE [TOTAL DE VENDAS] >= 500 ORDER BY [TOTAL DE VENDAS];

SELECT TOP 5 * FROM POKE WHERE [TOTAL DE VENDAS] >= 500 ORDER BY [TOTAL DE VENDAS] DESC;

SELECT TOP 10 * FROM POKE WHERE [VALOR DE VENDA] >= 22 ORDER BY [TOTAL DE VENDAS];

--SOMANDO
SELECT * FROM P_COMECAR;

SELECT SUM ([TOTAL DE VENDAS]) AS [TOTAL LIQUIDO], SUM (QUANTIDADE) AS QTD  FROM P_COMECAR;

--Somando bem detalhado
SELECT AVG ([TOTAL DE VENDAS]) AS [TOTAL LIQUIDO] FROM P_COMECAR;

-- Maximo e mínimo dos valores
SELECT * FROM YAKISOBA;

SELECT MAX([TOTAL DE VENDAS]) FROM YAKISOBA;

SELECT MAX([TOTAL DE VENDAS]) AS MAXIMO, MAX(QUANTIDADE) AS QTD FROM YAKISOBA;

SELECT MIN([TOTAL DE VENDAS]) AS [MINIMO VENDAS], MIN([VALOR DE VENDA]) AS [VALOR MINIMO] FROM YAKISOBA;

SELECT MAX([TOTAL DE VENDAS]) AS [MAXIMO VENDAS], MIN([TOTAL DE VENDAS]) AS [VALOR MAXIMO] FROM YAKISOBA;

SELECT MAX([TOTAL DE VENDAS]) AS [MAXIMO VENDAS], MIN([TOTAL DE VENDAS]) AS [VALOR MAXIMO] FROM YAKISOBA


-- STATUS DA VENDA SE NÃO FOR UM É OUTRO

SELECT * FROM BIGMAKI;
SELECT PRODUTO, [VALOR DE VENDA], [TOTAL DE VENDAS],
(CASE WHEN [TOTAL DE VENDAS] >= 500 THEN 'BOA VENDA' ELSE 'POUCA VENDA'END) AS STATUS FROM BIGMAKI;

SELECT PRODUTO,UNIDADES, [VALOR DE VENDA], [TOTAL DE VENDAS],
(CASE WHEN [VALOR DE VENDA] >= 20 THEN 'PRODUTO CARO' ELSE 'PRODUTO EM CONTA'END) AS STATUS FROM BIGMAKI
WHERE UNIDADES = 'copacabana' ORDER BY [VALOR DE VENDA];

SELECT PRODUTO,UNIDADES, [VALOR DE VENDA], [TOTAL DE VENDAS],
(CASE WHEN [TOTAL DE VENDAS] <= 300 THEN 'PRODUTO NA MEDIA'
      WHEN [TOTAL DE VENDAS] >= 500 THEN 'PRODUTO CARO'
	  ELSE 'PRODUTO EM CONTA'END) AS STATUS FROM BIGMAKI
WHERE UNIDADES = 'copacabana' ORDER BY STATUS;



-- UNIR TABELAS
SELECT DISTINCT PRODUTO FROM SOBREMESA
UNION
SELECT DISTINCT PRODUTO FROM BIGMAKI
UNION
SELECT DISTINCT PRODUTO FROM EXECUTIVO
UNION
SELECT DISTINCT PRODUTO FROM HEALTHY
UNION
SELECT DISTINCT PRODUTO FROM MENU_KIDS
UNION
SELECT DISTINCT PRODUTO FROM NORI_ESPECIAL
UNION
SELECT DISTINCT PRODUTO FROM P_COMECAR
UNION
SELECT DISTINCT PRODUTO FROM POKE
UNION
SELECT DISTINCT PRODUTO FROM YAKISOBA;

-- Funções

SELECT PRODUTO, LOWER(PRODUTO) AS [PRODUTO MINUSCULO] FROM SOBREMESA; -- TUDO MINUSCULO

SELECT PRODUTO, UPPER(PRODUTO) AS [PRODUTO MINUSCULO], UPPER(UNIDADES) AS UNIDADE_MAIUSCULO FROM YAKISOBA; -- TUDO MAISCULO

SELECT PRODUTO, REPLACE(PRODUTO, 'Gyosa legumes','Legumes') AS sabor_MODIFICADO FROM P_COMECAR;

SELECT * FROM P_COMECAR

--Funçaõ de datas 

SELECT GETDATE() -- DATA DE HOJE DETALHES


--DATA DE DIA, MÊS E ANO DE HOJE
SELECT GETDATE(), GETDATE() DATA_HOJE, DATEPART(DAY, GETDATE()) AS DIA_DE_HOJE 
SELECT GETDATE(), GETDATE() DATA_HOJE, DATEPART(YEAR, GETDATE()) AS ANO 
SELECT GETDATE(), GETDATE() DATA_HOJE, DATEPART(YEAR, GETDATE()) AS MES 

--PREVISÃO DE DATAS
SELECT GETDATE() AS DATA_HOJE, DATEADD(DAY, 10, GETDATE()) AS DATA_DAQUI_10_DIAS
SELECT GETDATE() AS DATA_HOJE, DATEADD(MONTH, 1, GETDATE()) AS DATA_DAQUI_1_MES
SELECT GETDATE() AS DATA_HOJE, DATEADD(YEAR, 1, GETDATE()) AS DATA_DAQUI_1_ANO


